<!doctype html>
<html lang="en"> 
  <head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Property Details</title> 
    <style>
      body {
        font-family: sans-serif;
        background-color: #1a1a1a;
        color: #fff;
        margin: 0;
        padding: 0;
      }
      .container {
        max-width: 960px;
        margin: 0 auto;
        padding: 20px;
      }
      .property-details {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
      }
      .image-container {
        flex: 0 0 50%;
        max-width: 50%;
      }
      .image-container img {
        width: 100%;
        height: auto;
        border-radius: 5px;
      }
      .details-container {
        flex: 0 0 50%;
        max-width: 50%;
      }
      .details-container h1 {
        color: gold;
        margin-bottom: 10px;
      }
      .details-container p {
        margin-bottom: 15px;
      }
      .details-container ul {
        list-style: none;
        padding: 0;
      }
      .details-container li {
        margin-bottom: 5px;
      }
      .amenities {
        margin-top: 20px;
      }
      .amenities h2 {
        color: gold;
        margin-bottom: 10px;
      }
      .amenities ul {
        list-style-type: disc;
        padding-left: 20px;
      }
      .contact {
        margin-top: 30px;
        text-align: center;
      }
      .contact button {
        background-color: gold;
        color: #1a1a1a;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
      }
      @media screen and (max-width: 768px) {
        .property-details {
          flex-direction: column;
        }
        .image-container, .details-container {
          flex: 0 0 100%;
          max-width: 100%;
        }
      }
    </style> 
  </head> 
  <body> 
    <div class="container"> 
      <div class="property-details"> 
        <div class="image-container"> 
          <img id="propertyImage" src="property-image.jpg" alt="Property Image"> 
        </div> 
        <div class="details-container"> 
          <h1 id="propertyTitle">Luxury Villa in the Heart of the City</h1> 
          <p id="propertyDescription">This stunning villa offers a luxurious lifestyle with spacious interiors, a private garden, and a swimming pool.</p> 
          <ul id="propertySpecs"> 
            <li><strong>Bedrooms:</strong> <span id="propertyBedrooms">4</span></li> 
            <li><strong>Bathrooms:</strong> <span id="propertyBathrooms">5</span></li> 
            <li><strong>Size:</strong> <span id="propertySize">5000 sq ft</span></li> 
            <li><strong>Price:</strong> <span id="propertyPrice">Ksh 5,000,000</span></li> 
          </ul> 
        </div> 
      </div> 
      <div class="amenities"> 
        <h2>Amenities</h2> 
        <ul id="propertyAmenities"> 
          <li>Private Swimming Pool</li> 
          <li>Home Theater</li> 
          <li>Gourmet Kitchen</li> 
          <li>Home Office</li> 
          <li>Fitness Center</li> 
          <li>24/7 Security</li> 
        </ul> 
      </div> 
      <div class="contact"> 
        <button>Contact Agent</button> 
      </div> 
    </div> 
    <script>
      // Backendless credentials and settings
      const APP_ID = '9F28C534-8DE5-4505-8E67-3D4C16FFDD63';
      const REST_API_KEY = '074FA8E4-7EA4-4EF3-83F8-74A692AE38ED';
      const BASE_URL = `https://api.backendless.com/${APP_ID}/${REST_API_KEY}/data/Properties`;

      // Utility: Get query parameter by name (e.g., "id")
      function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
      }

      // Load and display property details based on the "id" URL parameter
      async function loadPropertyDetails() {
        const propertyId = getQueryParam('id');
        if (!propertyId) {
          console.error('No property ID provided in the URL.');
          return;
        }
        try {
          const response = await fetch(`${BASE_URL}/${propertyId}`);
          if (!response.ok) {
            throw new Error('Failed to fetch property details');
          }
          const property = await response.json();

          // Update the image: if property.imageurls is available, use its first image.
          let images = property.imageurls;
          if (typeof images === 'string') {
            try {
              images = JSON.parse(images);
            } catch (e) {
              images = [];
            }
          }
          const imageUrl = (images && images.length) ? images[0] : 'property-image.jpg';
          document.getElementById('propertyImage').src = imageUrl;

          // Update textual details
          document.getElementById('propertyTitle').textContent = property.title || 'Untitled Property';
          document.getElementById('propertyDescription').textContent = property.description || '';
          document.getElementById('propertyBedrooms').textContent = property.bedrooms || 'N/A';
          document.getElementById('propertyBathrooms').textContent = property.bathrooms || 'N/A';
          document.getElementById('propertySize').textContent = property.size || 'N/A';
          document.getElementById('propertyPrice').textContent = property.price ? `Ksh ${property.price}` : 'N/A';

          // Update amenities if available (assumes property.amenities is a comma-separated string or an array)
          if (property.amenities) {
            const amenitiesEl = document.getElementById('propertyAmenities');
            amenitiesEl.innerHTML = '';
            const amenitiesArray = Array.isArray(property.amenities)
              ? property.amenities
              : property.amenities.split(',');
            amenitiesArray.forEach(amenity => {
              const li = document.createElement('li');
              li.textContent = amenity.trim();
              amenitiesEl.appendChild(li);
            });
          }
        } catch (error) {
          console.error('Error loading property details:', error);
        }
      }

      document.addEventListener('DOMContentLoaded', loadPropertyDetails);
    </script>
  </body>
</html>









